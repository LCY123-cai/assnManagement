(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c78b8398"],{"2e2e":function(e,t,n){},"3f2a":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("b775");function a(e,t){return Object(r["a"])({header:{"Content-Type":"application/xlsx"},responseType:"blob",method:"get",url:t,params:e})}},"456d":function(e,t,n){var r=n("4bf8"),a=n("0d58");n("5eda")("keys",(function(){return function(e){return a(r(e))}}))},"5eda":function(e,t,n){var r=n("5ca1"),a=n("8378"),s=n("79e5");e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*s((function(){n(1)})),"Object",o)}},"67a7":function(e,t,n){},"6a6f":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i}));var r=n("b775");function a(e){return Object(r["a"])({url:"/department/list",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/department/create",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/department/edit",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/department/disband",method:"post",data:e})}},"76db":function(e,t,n){"use strict";var r=n("2e2e"),a=n.n(r);a.a},8362:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"assnListContainer"},[n("el-form",{staticClass:"demo-form-inline baseFrom",attrs:{inline:!0,model:e.assnForm,"label-width":"100px","label-position":"right"}},[n("el-form-item",{attrs:{label:"社团名称"}},[n("x-input",{attrs:{autocomplete:!0,"fetch-suggestions":e.querySearchAsync,"value-key":"assnName"},on:{select:e.assnChange,input:e.assnInput},model:{value:e.assnForm.assnName,callback:function(t){e.$set(e.assnForm,"assnName",t)},expression:"assnForm.assnName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"社团部门"}},[n("x-select",{attrs:{disabled:e.departmentBan,options:e.handleDepartment},on:{change:e.change},model:{value:e.assnForm.assnDeparment,callback:function(t){e.$set(e.assnForm,"assnDeparment",t)},expression:"assnForm.assnDeparment"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"社员名称"}},[n("x-input",{model:{value:e.assnForm.userName,callback:function(t){e.$set(e.assnForm,"userName",t)},expression:"assnForm.userName"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),e._v(" "),n("el-button",{attrs:{type:"primary",plain:""},on:{click:e.reset}},[e._v("重置")])],1)],1),e._v(" "),n("div",{staticClass:"btnGroup"},[n("el-button",{attrs:{type:"primary"},on:{click:e.addMemberBtn}},[e._v("添加社员")]),e._v(" "),n("el-button",{attrs:{type:"primary",disabled:!e.assnPermission},on:{click:e.editMemberBtn}},[e._v("修改社员")]),e._v(" "),n("el-button",{attrs:{type:"primary",disabled:!e.systemPermission&&!e.assnPermission},on:{click:e.disbandMemberBtn}},[e._v("开除社员")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.importExcelBtn}},[e._v("导入")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出")])],1),e._v(" "),n("x-table",{ref:"grid",attrs:{config:e.config}}),e._v(" "),n("createMemberForm",{ref:"addMemberForm"}),e._v(" "),n("editMemberForm",{ref:"editMemberForm",attrs:{memberInfo:e.pitchMember}}),e._v(" "),n("importExcel",{ref:"importExcel"})],1)},a=[],s=n("db72"),o=(n("ac4d"),n("8a81"),n("ac6a"),n("456d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("x-dialog",{ref:"dialog",attrs:{title:"添加社员",saveText:"添加"},on:{submit:e.createAssnMember}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"可操作社团",prop:"assnId"}},[n("x-select",{attrs:{placeholder:"请选择",options:e.handleAssns},on:{change:e.assnChange},model:{value:e.ruleForm.assnId,callback:function(t){e.$set(e.ruleForm,"assnId",t)},expression:"ruleForm.assnId"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"社团部门",prop:"departmentId"}},[n("x-select",{attrs:{placeholder:"请选择",disabled:e.departmentBan,options:e.handleDepartment},model:{value:e.ruleForm.departmentId,callback:function(t){e.$set(e.ruleForm,"departmentId",t)},expression:"ruleForm.departmentId"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"预添加社员",prop:"userId"}},[n("x-select",{attrs:{placeholder:"请输入",filterable:"",remote:"","remote-method":e.remoteMethod,loading:e.loading,options:e.memberName,append:e.memberCode},model:{value:e.ruleForm.userId,callback:function(t){e.$set(e.ruleForm,"userId",t)},expression:"ruleForm.userId"}})],1)],1)],1)}),i=[],l=n("6a6f"),u=n("c24f"),c=n("d4d8"),d={props:{},data:function(){return{departmentBan:!0,handleDepartment:[],loading:!1,memberName:[],memberCode:[],ruleForm:{assnId:"",departmentId:"",userId:""},rules:{assnId:[{required:!0,message:"请选择操作社团",trigger:"change"}],departmentId:[{required:!0,message:"请选择加入部门",trigger:"change"}],userId:[{required:!0,message:"请选择人员",trigger:"change"}]}}},methods:{open:function(){var e=this;this.$refs.dialog.open(),this.$nextTick((function(){e.$refs.ruleForm.resetFields()}))},createAssnMember:function(e,t){var n=this;this.$refs.ruleForm.validate((function(r){if(!r)return!1;var a=Object.assign({},n.ruleForm);n.$refs.dialog.openLoading(),Object(c["a"])(a).then((function(e){n.$message({message:"创建社团成员成功",type:"success"}),n.$parent.$refs.grid.queryData(!0),t()})).catch((function(t){e()}))}))},assnChange:function(e){var t=this;if(e){this.departmentBan=!1;var n={assnId:e};Object(l["b"])(n).then((function(e){var n=e.data,r=[],a=!0,s=!1,o=void 0;try{for(var i,l=n[Symbol.iterator]();!(a=(i=l.next()).done);a=!0){var u=i.value,c={};c.value=u.departmentId,c.label=u.departmentName,r.push(c)}}catch(d){s=!0,o=d}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}t.handleDepartment=r}))}},remoteMethod:function(e){var t=this;e.length>0&&(this.loading=!0,Object(u["c"])(!1).then((function(n){t.loading=!1;var r=n.data,a=[],s=[],o=!0,i=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value,m={};-1!==d.userName.indexOf(e)&&(m.value=d.userId,m.label=d.userName,a.push(m),s.push(d.userAccount))}}catch(p){i=!0,l=p}finally{try{o||null==c.return||c.return()}finally{if(i)throw l}}t.memberName=a,t.memberCode=s})).catch((function(e){t.loading=!1})))}},computed:{handleAssns:function(){var e=this.$store.state.user.assnIds,t=this.$store.state.user.assnNames,n=[];return e.forEach((function(e,r,a){var s={};s.value=e,s.label=t[r],n.push(s)})),n}},watch:{"ruleForm.assnId":function(e,t){e?this.ruleForm.departmentId="":(this.departmentBan=!0,this.ruleForm.departmentId="")}}},m=d,p=n("2877"),f=Object(p["a"])(m,o,i,!1,null,null,null),h=f.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("x-dialog",{ref:"dialog",attrs:{title:"修改社员部门",saveText:"修改"},on:{submit:e.editAssnMember}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"可操作社团",prop:"assnId"}},[n("x-select",{attrs:{placeholder:"请选择",options:e.handleAssns},on:{change:e.assnChange},model:{value:e.ruleForm.assnId,callback:function(t){e.$set(e.ruleForm,"assnId",t)},expression:"ruleForm.assnId"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"社团部门",prop:"departmentId"}},[n("x-select",{attrs:{placeholder:"请选择",disabled:e.departmentBan,options:e.handleDepartment},model:{value:e.ruleForm.departmentId,callback:function(t){e.$set(e.ruleForm,"departmentId",t)},expression:"ruleForm.departmentId"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"操作社员"}},[n("strong",{domProps:{textContent:e._s(e.ruleForm.userName)}})])],1)],1)},g=[],v={props:{memberInfo:{type:Object,required:!0}},data:function(){return{departmentBan:!0,handleDepartment:[],loading:!1,memberName:[],memberCode:[],ruleForm:{assnId:"",departmentId:""},rules:{assnId:[{required:!0,message:"请选择操作社团",trigger:"change"}],departmentId:[{required:!0,message:"请选择加入部门",trigger:"change"}]}}},methods:{open:function(){this.$refs.dialog.open(),this.ruleForm=Object.assign({},this.memberInfo),this.assnChange(this.ruleForm.assnId)},editAssnMember:function(e,t){var n=this;this.$refs.ruleForm.validate((function(r){if(!r)return!1;var a=n.memberInfo,s=a.assnId,o=a.departmentId,i=(a.id,{oldAssnId:s,oldDepartmentId:o}),l=Object.assign({},n.ruleForm,i);n.$refs.dialog.openLoading(),Object(c["c"])(l).then((function(e){n.$message({message:"修改社团成员成功",type:"success"}),n.$parent.$refs.grid.queryData(!0),t()})).catch((function(t){e()}))}))},assnChange:function(e){var t=this;if(e){this.departmentBan=!1;var n={assnId:e};Object(l["b"])(n).then((function(e){var n=e.data,r=[],a=!0,s=!1,o=void 0;try{for(var i,l=n[Symbol.iterator]();!(a=(i=l.next()).done);a=!0){var u=i.value,c={};c.value=u.departmentId,c.label=u.departmentName,r.push(c)}}catch(d){s=!0,o=d}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}t.handleDepartment=r}))}}},computed:{handleAssns:function(){var e=this.$store.state.user.assnIds,t=this.$store.state.user.assnNames,n=[];return e.forEach((function(e,r,a){var s={};s.value=e,s.label=t[r],n.push(s)})),n}},watch:{"ruleForm.assnId":function(e,t){e?this.ruleForm.departmentId="":(this.departmentBan=!0,this.ruleForm.departmentId="")},memberInfo:function(e,t){this.ruleForm=Object.assign({},e)}}},x=v,y=Object(p["a"])(x,b,g,!1,null,null,null),F=y.exports,$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("x-dialog",{ref:"dialog",attrs:{title:"导入社团成员",saveText:"上传"},on:{submit:e.importExcel}},[n("div",{staticClass:"importExcel"},[n("div",{staticClass:"download"},[n("el-button",{attrs:{type:"primary"},on:{click:e.templateDownload}},[e._v("下载模版")])],1),e._v(" "),n("div",[n("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"","auto-upload":!1,limit:1,action:e.url,accept:".xlsx, .xls",data:e.userId,"on-success":e.handle}},[n("i",{staticClass:"el-icon-upload"}),e._v(" "),n("div",{staticClass:"el-upload__text"},[e._v("\n          将文件拖到此处，或\n          "),n("em",[e._v("点击选取文件")])]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xlsx/xls文件，请尽量使用模版进行上传")])])],1)])])},I=[],O=n("3f2a"),j={props:{},data:function(){return{url:"/prod-api/assnMember/import",userId:{userId:this.$store.state.user.userId}}},methods:{open:function(){this.$refs.dialog.open(),this.$nextTick((function(){this.$refs.upload.clearFiles()}))},templateDownload:function(){var e=this;this.$shade(),Object(O["a"])({},"/assnMember/template").then((function(t){e.$shade.close(),e.$excel(t,"社团成员")})).catch((function(t){e.$shade.close()}))},importExcel:function(e,t){this.$refs.upload.submit(),this.$refs.dialog.openLoading()},handle:function(e,t,n){this.$refs.dialog.closeLoading(),"20000"!==e.code?(this.$message.error(e.msg),this.$refs.upload.clearFiles()):(this.$message({message:"上传成功",type:"success"}),this.$refs.dialog.close(),this.$parent.$refs.grid.queryData(!0))}},computed:{}},_=j,M=(n("e01e"),Object(p["a"])(_,$,I,!1,null,null,null)),C=M.exports,k=n("b618"),w={components:{createMemberForm:h,editMemberForm:F,importExcel:C},data:function(){var e=this;return{assnForm:{},departmentBan:!0,handleDepartment:[],pitchMember:{},memberInfo:{},config:{url:"/assnMember/list",params:{},attrs:{"highlight-current-row":!0},events:{"current-change":function(t){e.pitchMember=t||{}}},pagination:{"page-size":10,"page-size-opts":[10,20,30,40]},columns:[{label:"序号",type:"index",width:70},{label:"社团名称",prop:"assnName"},{label:"部门名称",prop:"departmentName"},{label:"社员名称",prop:"userName"},{label:"社员性别",prop:"userGender",selects:"sex"},{label:"社员电话",prop:"userPhone"},{label:"社员邮箱",prop:"userEmail","min-width":"100"},{label:"加入时间",prop:"gmtCreate",format:"time"}]}}},methods:{search:function(){this.config.params=Object.assign({},this.assnForm),this.$refs.grid.queryData(!0)},reset:function(){this.assnForm={},this.config.params=this.assnForm,this.$refs.grid.queryData(!0)},addMemberBtn:function(){this.$refs.addMemberForm.open()},editMemberBtn:function(){Object.keys(this.pitchMember).length>0?this.$refs.editMemberForm.open():this.$message({message:"请至少选择一条数据",type:"warning"})},disbandMemberBtn:function(){var e=this;Object.keys(this.pitchMember).length>0?this.$confirm('你确定要开除&nbsp;<strong style="color: #F56C6C;">'.concat(this.pitchMember.userName,"</strong>&nbsp;这个社员吗？"),"开除社员",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",closeOnClickModal:!1,dangerouslyUseHTMLString:!0}).then((function(){var t=e.pitchMember;Object(c["b"])(t).then((function(t){e.$message({message:"删除社团成员成功",type:"success"}),e.$refs.grid.queryData(!0)})).catch((function(e){}))})).catch((function(){})):this.$message({message:"请至少选择一条数据",type:"warning"})},querySearchAsync:function(e,t){e?Object(k["c"])().then((function(n){var r=n.data,a=e?r.filter((function(t,n,r){return-1!==t.assnName.toLowerCase().indexOf(e.toLowerCase())})):r;t(a)})):t([])},assnChange:function(e){var t=this;this.departmentBan=!1;var n={assnId:e.assnId};Object(l["b"])(n).then((function(e){var n=e.data,r=[],a=!0,s=!1,o=void 0;try{for(var i,l=n[Symbol.iterator]();!(a=(i=l.next()).done);a=!0){var u=i.value,c={};c.value=u.departmentId,c.label=u.departmentName,r.push(c)}}catch(d){s=!0,o=d}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}t.handleDepartment=r}))},assnInput:function(){this.departmentBan=!0,this.assnForm.assnDeparment=""},change:function(){this.$forceUpdate()},exportExcel:function(){var e=this;this.$shade(),Object(O["a"])(Object(s["a"])({},this.$refs.grid.config.params),"/assnMember/export").then((function(t){e.$excel(t,"社团成员"),e.$shade.close(),e.$message({type:"success",message:"导出成功！"})})).catch((function(t){e.$shade.close()}))},importExcelBtn:function(){this.$refs.importExcel.open()}},computed:{systemPermission:function(){return-1!==this.$store.state.user.roles.indexOf("admin")},assnPermission:function(){return-1!==this.$store.state.user.assnIds.indexOf(this.pitchMember.assnId)}},watch:{"assnForm.assnName":function(e,t){e||(this.departmentBan=!0,this.assnForm.assnDeparment="")}}},N=w,B=(n("76db"),Object(p["a"])(N,r,a,!1,null,"2a580414",null));t["default"]=B.exports},b618:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"j",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"k",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"f",(function(){return f}));var r=n("b775");function a(e){return Object(r["a"])({url:"/assn/list",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/assn/nameList",method:"get",params:e})}function o(){return Object(r["a"])({url:"/assn/handleAssn",method:"get"})}function i(e){return Object(r["a"])({url:"/assn/create",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/assn/edit",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/assn/disband",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/assn/changeHiring",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/assn/typeList",method:"get"})}function m(e){return Object(r["a"])({url:"/assn/addType",method:"post",data:e})}function p(e){return Object(r["a"])({url:"/assn/editType",method:"post",data:e})}function f(e){return Object(r["a"])({url:"/assn/deleteType",method:"post",data:e})}},d4d8:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("b775");function a(){return Object(r["a"])({url:"/assnMember/myAssn",method:"get"})}function s(e){return Object(r["a"])({url:"/assnMember/assnSex",method:"get",params:e})}function o(e){return Object(r["a"])({url:"/assnMember/assnCount",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/assnMember/create",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/assnMember/edit",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/assnMember/disband",method:"post",data:e})}},e01e:function(e,t,n){"use strict";var r=n("67a7"),a=n.n(r);a.a}}]);